<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Apache Camel 4.x Upgrade Guide :: Red Hat build of Apache Camel</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Red Hat build of Apache Camel</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="manual" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">User manual</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="getting-started.html">Getting started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="what-are-the-dependencies.html">What are the dependencies?</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources &amp; Guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="/community/books/">Books</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="building.html">Building</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-console.html">Camel Developer Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="camel-jbang.html">Camel JBang</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="camel-jbang-kubernetes.html">Camel Kubernetes plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-maven-plugin.html">Camel Maven Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-component-maven-plugin.html">Camel Component Maven Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-report-maven-plugin.html">Camel Maven Report Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-maven-archetypes.html">Camel Maven Archetypes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuring-route-startup-ordering-and-autostartup.html">Configuring route startup ordering and autostartup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="component-dsl.html">Component DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Endpoint-dsl.html">Endpoint DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dataformat-dsl.html">DataFormat DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="examples.html">Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="graceful-shutdown.html">Graceful Shutdown</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="error-handler.html">Error handler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="using-propertyplaceholder.html">How to use Camel property placeholders</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="variables.html">How to use Variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="testing.html">Testing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="test-infra.html">Test Infra</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="notify-builder.html">NotifyBuilder</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="advice-with.html">AdviceWith</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="rest-dsl.html">Working with REST and Rest DSL</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="rest-dsl-openapi.html">Rest DSL contract first</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="writing-components.html">Writing Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="release-guide.html">Release guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="release-guide-website.html">Adding doc versions to the website</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="improving-the-documentation.html">Improving the Documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="migration-and-upgrade.html">Migration and Upgrade</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-3-migration-guide.html">Camel 2.x to 3.0 Migration Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-3x-upgrade-guide.html">Camel 3.x Upgrade Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-4-migration-guide.html">Camel 3.x to 4.0 Migration Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-4x-upgrade-guide.html">Camel 4.x Upgrade Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="architecture.html">Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backlog-debugger.html">Backlog debugger</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backlog-tracer.html">Backlog Tracer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="batch-consumer.html">Batch Consumer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bean-binding.html">Bean Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bean-integration.html">Bean Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camelcontext.html">CamelContext</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camelcontext-autoconfigure.html">CamelContext Auto Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="clustering.html">Clustering and Load Balancing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="component.html">Component</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="data-format.html">Data Format</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="debugger.html">Debugger</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="delay-interceptor.html">Delayer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endpoint.html">Endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endpoint-annotations.html">Endpoint Annotations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exception-clause.html">Exception Clause</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exchange-pooling.html">Exchange Pooling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http-session-handling.html">HTTP-Session Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parameter-binding-annotations.html">Parameter Binding Annotations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pojo-producing.html">POJO Producing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pojo-consuming.html">POJO Consuming</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="producertemplate.html">ProducerTemplate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="consumertemplate.html">ConsumerTemplate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="error-handler.html">Error Handler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exchange.html">Message Exchange</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="using-exchange-pattern-annotations.html">Using Exchange pattern annotations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="expression.html">Expressions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/4.10.3/eips/content-enricher.html">Content Enrichment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="injector.html">Injector</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/4.10.3/eips/intercept.html">Intercept</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jmx.html">JMX</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lifecycle.html">Camel Lifecycle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="oncompletion.html">OnCompletion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pluggable-class-resolvers.html">Pluggable Class Resolvers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="predicate.html">Predicates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="processor.html">Processor</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="registry.html">Registry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-builder.html">RouteBuilder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lambda-route-builder.html">LambdaRouteBuilder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-controller.html">RouteController</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-policy.html">RoutePolicy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-configuration.html">RouteConfiguration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="context-reload.html">ContextReload</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-reload.html">RouteReload</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-template.html">RouteTemplate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="routes.html">Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="startup-condition.html">Startup Condition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stream-caching.html">Stream caching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="transformer.html">Transformer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="threading-model.html">Threading Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tracer.html">Tracer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="type-converter.html">Type Converter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="uris.html">URIs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="uuidgenerator.html">UuidGenerator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="validator.html">Validator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="health-check.html">Health Checks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Domain Specific Languages</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl.html">Camel Domain Specific Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="languages.html">Languages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="java-dsl.html">Java DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="spring.html">Spring support</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="faq/index.html">FAQ</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/can-i-get-commercial-support.html">Can I get commercial support?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="/community/support/">How can I get help?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-get-the-source-code.html">How can I get the source code?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-does-camel-work.html">How does Camel work?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-does-the-website-work.html">How does the website work?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-become-a-committer.html">How do I become a committer?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-compile-the-code.html">How do I compile the code?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-edit-the-website.html">How do I edit the website?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/running-camel-standalone.html">Running Camel standalone</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-is-a-router.html">What is a router?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-is-camel.html">What is Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-is-the-license.html">What is the license?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="languages.html">What languages are supported?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-platforms-are-supported.html">What platforms are supported?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-the-name-camel.html">Why the name Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-specify-which-method-to-use-when-using-beans-in-routes.html">How do I specify which method to use when using beans in routes?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-create-a-custom-component-or-endpoint.html">How can I create a custom component or endpoint?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-get-the-remote-connection-ip-address-from-the-camel-cxf-consumer-.html">How can I get the remote connection IP address from the camel-cxf consumer ?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-stop-a-route-from-a-route.html">How can I stop a route from a route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-webservice-clients-see-remote-faults-with-stacktraces-when-using-camel-cxf.html">How can webservice clients see remote faults with stacktraces when using camel-cxf?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-does-camel-look-up-beans-and-endpoints.html">How does Camel look up beans and endpoints?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-change-the-logging.html">How do I change the logging?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-endpoints.html">How do I configure endpoints?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-password-options-on-camel-endpoints-without-the-value-being-encoded.html">How do I configure password options on Camel endpoints without the value being encoded?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-the-default-maximum-cache-size-for-producercache-or-producertemplate.html">How do I configure the default maximum cache size for ProducerCache or ProducerTemplate?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-the-maximum-endpoint-cache-size-for-camelcontext.html">How do I configure the maximum endpoint cache size for CamelContext?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-debug-my-route.html">How do I debug my route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-disable-jmx.html">How do I disable JMX?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-enable-streams-when-debug-logging-messages-in-camel.html">How do I enable streams when debug logging messages in Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-handle-failures-when-consuming-for-example-from-a-ftp-server.html">How do I handle failures when consuming for example from a FTP server?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-import-rests-from-other-xml-files.html">How do I import rests from other XML files?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-import-routes-from-other-xml-files.html">How do I import routes from other XML files?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-let-jetty-match-wildcards.html">How do I let Jetty match wildcards?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-name-my-routes.html">How do I name my routes?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-restart-camelcontext.html">How do I restart CamelContext?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-retrieve-the-thrown-exception-during-processing-an-exchange.html">How do I retrieve the thrown Exception during processing an Exchange?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-retry-failed-messages-forever.html">How do I retry failed messages forever?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-retry-processing-a-message-from-a-certain-point-back-or-an-entire-route.html">How do I retry processing a message from a certain point back or an entire route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-reuse-the-contexttestsupport-class-in-my-unit-tests.html">How do I reuse the ContextTestSupport class in my unit tests?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-set-the-max-chars-when-debug-logging-messages-in-camel.html">How do I set the max chars when debug logging messages in Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-use-uris-with-parameters-in-xml.html">How do I use URIs with parameters in XML?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-write-a-custom-processor-which-sends-multiple-messages.html">How do I write a custom Processor which sends multiple messages?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-should-i-invoke-my-pojos-or-spring-services.html">How should I invoke my POJOs or Spring Services?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-avoid-sending-some-or-all-message-headers.html">How to avoid sending some or all message headers?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-remove-the-http-protocol-headers-in-the-camel-message.html">How to remove the http protocol headers in the camel message?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-send-the-same-message-to-multiple-endpoints.html">How to send the same message to multiple endpoints?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-switch-the-cxf-consumer-between-http-and-https-without-touching-the-spring-configuration.html">How to switch the CXF consumer between HTTP and HTTPS without touching the Spring configuration?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-use-a-dynamic-uri-in-to.html">How to use a dynamic URI in to()?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/is-there-an-ide.html">Is there an IDE?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/using-getin-or-getout-methods-on-exchange.html">Using getIn or getOut methods on Exchange</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-cant-i-use-sign-in-my-password.html">Why can&#8217;t I use + sign in my password?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-can-i-not-use-when-or-otherwise-in-a-java-camel-route.html">Why can I not use when or otherwise in a Java Camel route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-ftp-component-not-download-any-files.html">Why does FTP component not download any files?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-my-file-consumer-not-pick-up-the-file-and-how-do-i-let-the-file-consumer-use-the-camel-error-handler.html">Why does my file consumer not pick up the file, and how do I let the file consumer use the Camel error handler?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-useoriginalmessage-with-error-handler-not-work-as-expected.html">Why does useOriginalMessage with error handler not work as expected?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-do-my-message-lose-its-headers-during-routing.html">Why do my message lose its headers during routing?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-is-my-message-body-empty.html">Why is my message body empty?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-is-my-processor-not-showing-up-in-jconsole.html">Why is my processor not showing up in JConsole?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-is-the-exception-null-when-i-use-onexception.html">Why is the exception null when I use onException?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-use-multiple-camelcontext.html">Why use multiple CamelContext?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-enable-debug-logging.html">How do I enable debug logging?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-use-log4j.html">How do I use log4j?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-make-my-jms-endpoint-transactional.html">How Do I Make My JMS Endpoint Transactional?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-set-the-mep-when-interacting-with-jbi.html">How do I set the MEP when interacting with JBI?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-the-direct-event-seda-and-vm-endpoints-compare.html">How do the direct, event, seda and vm endpoints compare?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-the-timer-and-quartz-endpoints-compare.html">How do the Timer and Quartz endpoints compare?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-my-jms-route-only-consume-one-message-at-once.html">Why does my JMS route only consume one message at once?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/exception-beandefinitionstoreexception.html">Exception - BeanDefinitionStoreException</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/exception-orgapachecamelnosuchendpointexception.html">Exception - org.apache.camel.NoSuchEndpointException</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/exception-orgxmlsaxsaxparseexception.html">Exception - org.xml.sax.SAXParseException</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/memory-leak-when-adding-and-removing-routes-at-runtime.html">Memory leak when adding and removing routes at runtime</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-camel-use-too-many-threads-with-producertemplate.html">Why does Camel use too many threads with ProducerTemplate?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-maven-not-download-dependencies.html">Why does maven not download dependencies?</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><strong>Reference</strong></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/4.10.3/index.html">Components</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/4.10.3/dataformats/index.html">Data Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/4.10.3/languages/index.html">Languages</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/4.10.3/eips/enterprise-integration-patterns.html">EIPs</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">User manual</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../components/4.10.3/index.html">Camel Components</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../components/4.10.3/index.html">Next (Pre-release)</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="index.html">User manual</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">User manual</a></li>
    <li><a href="camel-4x-upgrade-guide-4_10.html">Apache Camel 4.x Upgrade Guide</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Apache Camel 4.x Upgrade Guide</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document is for helping you upgrade your Apache Camel application
from Camel 4.x to 4.y. For example, if you are upgrading Camel 4.0 to 4.2, then you should follow the guides
from both 4.0 to 4.1 and 4.1 to 4.2.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrading_camel_4_9_to_4_10"><a class="anchor" href="#_upgrading_camel_4_9_to_4_10"></a>Upgrading Camel 4.9 to 4.10</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_xml_dsl_changes"><a class="anchor" href="#_xml_dsl_changes"></a>XML DSL changes</h3>
<div class="paragraph">
<p>In <code>&lt;intercept</code>&gt; and <code>&lt;interceptSendToEndpoint&gt;</code> then <code>&lt;when&gt;</code> has been
renamed to <code>&lt;onWhen&gt;</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;intercept&gt;
  &lt;when&gt;...&lt;/when&gt;
  ...
&lt;/intercept&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Should now be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;intercept&gt;
  &lt;onWhen&gt;...&lt;/onWhen&gt;
  ...
&lt;/intercept&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <code>&lt;circuitBreaker</code> the <code>&lt;onFallback&gt;</code> section must be configured last.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;circuitBreaker&gt;
    &lt;resilience4jConfiguration timeoutEnabled="true" timeoutDuration="2000"/&gt;
    &lt;onFallback&gt;
      &lt;transform&gt;
        &lt;constant&gt;Fallback message&lt;/constant&gt;
      &lt;/transform&gt;
    &lt;/onFallback&gt;
    &lt;to uri="direct:foo"/&gt;
    ...
  &lt;/circuitBreaker&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Should now be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;circuitBreaker&gt;
    &lt;resilience4jConfiguration timeoutEnabled="true" timeoutDuration="2000"/&gt;
    &lt;to uri="direct:foo"/&gt;
    ...
    &lt;onFallback&gt;
      &lt;transform&gt;
        &lt;constant&gt;Fallback message&lt;/constant&gt;
      &lt;/transform&gt;
    &lt;/onFallback&gt;
  &lt;/circuitBreaker&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And <code>inheritErrorHandler</code> has been moved from <code>&lt;loadBalance&gt;</code> to <code>&lt;failoverLoadBalancer</code> which
is the only load balancer support this option.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;loadBalance inheritErrorHandler="true"&gt;
    &lt;failoverLoadBalancer maximumFailoverAttempts="3" roundRobin="true"/&gt;
    ...
  &lt;/loadBalance&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Should now be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;loadBalance&gt;
    &lt;failoverLoadBalancer maximumFailoverAttempts="3" roundRobin="true" inheritErrorHandler="true"/&gt;
    ...
  &lt;/loadBalance&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_camel_kamelet"><a class="anchor" href="#_camel_kamelet"></a>camel-kamelet</h3>
<div class="paragraph">
<p>The error handling when using kamelets has been refactored to let Kamelets re-use the same error handling
that are from the route where the kamelets are being used. Previously Kamelets did not have
any error handling.</p>
</div>
<div class="paragraph">
<p>Suppose you have kamelets that would cause an exception during processing, such
as the source below. Now because the route has been configured with a <em>dead letter channel</em>
as the error handler, then the exception from the kamelet will be handled by the route error handler.
Which means you will se a WARN being logged.</p>
</div>
<div class="paragraph">
<p>Previously the exception would <strong>not</strong> be handled by the route error handler, and the kamelet source
would always fail internally and cause a WARN being logged. Meaning that you did not have
any power to handle these errors.</p>
</div>
<div class="paragraph">
<p>Now the kamelets are <em>first class</em> and gives users the full power to handle errors as they see fit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- route:
    errorHandler:
      deadLetterChannel:
        deadLetterUri: log:dead?level=WARN
    id: myRoute
    from:
      uri: "kamelet:my-error-source/source"
      steps:
        - log: "${body}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This change has most an effect on source Kamelets. For sink or action Kamelets,
then any error would be propagated back to the route, that could still handle the error.
However, if the error handler is configured to perform retries, then the retry would be
starting all over again calling the sink Kamelet. This change will let the error handler
perform retries at the original of the error (also inside the Kamelet), the same as
regular Camel routes.</p>
</div>
<div class="paragraph">
<p>So suppose you have the following route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- route:
    errorHandler:
      deadLetterChannel:
        deadLetterUri: log:dead?level=WARN
        redeliveryPolicy:
          maximumRedeliveries: 5
          redeliveryDelay: "5000"
    id: myRoute
    from:
      uri: "direct:start"
      steps:
        - to:
            uri: "kamelet:my-error-sink/sink"
        - log: "${body}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then notice the error handler has been configured to do redeliveries up till 5 times with 5 sec delay between.
Suppose the sink kamelet is throwing an exception, then Camel will now perform the redelivery attempt
at the point of origin, which means inside the Kamelet. Previously the redelivery will
only happen at the route level, calling the kamelet all over again.</p>
</div>
<div class="paragraph">
<p>The option <code>noErrorHandler</code> has changed default from <code>true</code> to <code>false</code>. You should only
use this option if you want to turn on error handling inside Kamelets all together. However,
this should only be used in advanced/rare use-cases. This option may in the future be deprecated and removed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_azure_files"><a class="anchor" href="#_camel_azure_files"></a>camel-azure-files</h3>
<div class="paragraph">
<p>The class <code>org.apache.camel.component.file.azure.FilesHeaders</code> has been renamed to <code>org.apache.camel.component.file.azure.FilesConstants</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_aws2_s3"><a class="anchor" href="#_camel_aws2_s3"></a>camel-aws2-s3</h3>
<div class="paragraph">
<p>The header <code>CamelAwsS3BucketName</code> for setting a bucket to write to, on the producer side, cannot be used anymore: the header <code>CamelAwsS3OverrideBucketName</code> must be used
instead. This was done to avoid situation in which you&#8217;re moving a file from a bucket to a different one, and the header coming from the S3 consumer is used as bucket name for S3 Producer.
You can find more information on CAMEL-21680.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_file"><a class="anchor" href="#_camel_file"></a>camel-file</h3>
<div class="paragraph">
<p>The <code>camel-file</code> consumer has been optimized when filtering file names using name matching only,
to avoid creating an <code>GenericFile</code> object that represent the file. This is unnessasary if the file
is to be excluded due the filtering.</p>
</div>
<div class="paragraph">
<p>This optimization has changed APIs in the <code>camel-file</code> component to let methods that accept
<code>GenericFile</code> as parameter, has been changed to use a <code>Supplier&lt;GenericFile&gt;</code> to lazy create the wrapper.</p>
</div>
<div class="paragraph">
<p>Camel users who have created 3rd party component extending <code>camel-file</code> may need to migrate your components.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_google_storage"><a class="anchor" href="#_camel_google_storage"></a>camel-google-storage</h3>
<div class="paragraph">
<p>The header <code>CamelGoogleCloudStorageBucketName</code> for setting a bucket to write to, on the producer side, cannot be used anymore: the header <code>CamelGoogleCloudStorageOverrideBucketName</code> must be used
instead. This was done to avoid situation in which you&#8217;re moving a file from a bucket to a different one, and the header coming from the Google Storage consumer is used as bucket name for Google Storage Producer.
You can find more information on CAMEL-21682.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_jgroups"><a class="anchor" href="#_camel_jgroups"></a>camel-jgroups</h3>
<div class="paragraph">
<p>The cluster lock has been removed as it has been removed in JGroups 5.4 onwards, and it was
not recommended to be used in older JGroups releases. You can use another Camel component such as
<code>camel-infinispan</code> that has cluster locking.</p>
</div>
<div class="paragraph">
<p>The <code>camel-jgroups-cluster-service-starter</code> in Camel Spring Boot has been removed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_jbang"><a class="anchor" href="#_camel_jbang"></a>camel-jbang</h3>
<div class="paragraph">
<p>The camel-jbang commands for <code>camel-k</code> has been removed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_micrometer"><a class="anchor" href="#_camel_micrometer"></a>camel-micrometer</h3>
<div class="paragraph">
<p>We have fixed a flawed behavior when using dynamic endpoints which made the generation of endpoint events to grow in an uncontrolled way. From now on the component will generate events for the endpoint base URI as a default behavior. If you still want to collect events for the extended URI (including the parameters), then, you can use the <code>camel.metrics.baseEndpointURIExchangeEventNotifier=false</code> configuration. Mind that this is strongly discouraged as it can make your number of events growing out of control.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_mina"><a class="anchor" href="#_camel_mina"></a>camel-mina</h3>
<div class="paragraph">
<p>If using object codec, then you should configure the <code>objectCodecPattern</code> configuration to specify
which java classes (FQN) to allow for Object serialization. You can use <code>*</code> to accept all patterns.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_minio"><a class="anchor" href="#_camel_minio"></a>camel-minio</h3>
<div class="paragraph">
<p>The header <code>CamelMinioBucketName</code> for setting a bucket to write to, on the producer side, cannot be used anymore: the header <code>CamelMinioOverrideBucketName</code> must be used
instead. This was done to avoid situation in which you&#8217;re moving a file from a bucket to a different one, and the header coming from the Minio consumer is used as bucket name for Minio Producer.
You can find more information on CAMEL-21678.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_google_pubsub_lite"><a class="anchor" href="#_camel_google_pubsub_lite"></a>camel-google-pubsub-lite</h3>
<div class="paragraph">
<p>The component <code>camel-google-pubsub-lite</code> has been deprecated following the deprecation of the corresponding service by Google Cloud Platform.</p>
</div>
<div class="paragraph">
<p>Google recommends migrating your Pub/Sub Lite service to either Google Cloud Managed Service for Apache Kafka or Google Cloud Pub/Sub. Depending on your choice, you should use <code>camel-kafka</code> or <code>camel-google-pubsub component</code>, respectively.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_tracing"><a class="anchor" href="#_camel_tracing"></a>camel-tracing</h3>
<div class="paragraph">
<p>We have deprecated the setting of MDC <code>trace_id</code> and <code>span_id</code> in favour of implementation specific feature. You need to check the specific tracing/telemetry component configuration to learn how to switch from the deprecated configuration to the new one. Most of the time you will need to remove the <code>camel.main.use-mdc-logging</code> Camel property (or set it to <code>false</code>) and add dependencies and configuration settings to enable the specific component instrumentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_langchain4j_chat"><a class="anchor" href="#_camel_langchain4j_chat"></a>camel-langchain4j-chat</h3>
<div class="paragraph">
<p>The function calling feature was removed. Please use the <code>camel-langchain4j-tools</code> component for function calling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_smb"><a class="anchor" href="#_camel_smb"></a>camel-smb</h3>
<div class="paragraph">
<p>The <code>camel-smb</code> component has been updated to extend <code>GenericFile</code> classes and now supports more consumer and producer options.
The Consumer includes options for filtering, pre and post processing, duplicate handling, directory traversal, polling, and readlocks.
The Producer includes options for writing to temporary files, writing content, and handling existing files.</p>
</div>
</div>
<div class="sect2">
<h3 id="_camel_solr"><a class="anchor" href="#_camel_solr"></a>camel-solr</h3>
<div class="paragraph">
<p>The <code>camel-solr</code> component has been refactored. The <code>solrs</code> and <code>solrCloud</code> schemes have been deprecated in the uri format (but can still be enabled via the enableSSL and solrClient configuration options).
The solr operations have been simplified and some solr operations will be no longer be available in the next release. For those operations, a warning message will tell you how to get the same results with the new operations.
The Solr component exchange headers have been renamed and extended. As a consequence, the user should review the use of the Solr exchange headers and rename them when applicable.</p>
</div>
<div class="paragraph">
<p>All the solr headers has been renamed to use <code>CamelSolr</code> as prefix, such as <code>operation</code> &#8594; <code>CamelSolrOperation</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_camel_spring_boot"><a class="anchor" href="#_camel_spring_boot"></a>camel-spring-boot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>camel-k-starter</code> has been removed.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>

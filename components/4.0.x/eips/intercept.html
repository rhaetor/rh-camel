<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Intercept :: Red Hat build of Apache Camel</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Red Hat build of Apache Camel</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="components" data-version="4.0.x">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Camel Components</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="enterprise-integration-patterns.html">Enterprise Integration Patterns</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="aggregate-eip.html">Aggregate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bean-eip.html">Bean</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="change-data-capture.html">Change Data Capture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="channel-adapter.html">Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="choice-eip.html">Content Based Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="circuitBreaker-eip.html">Circuit Breaker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="claimCheck-eip.html">Claim Check</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="competing-consumers.html">Competing Consumers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="composed-message-processor.html">Composed Message Processor</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="content-enricher.html">Content Enricher</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="content-filter-eip.html">Content Filter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="convertBodyTo-eip.html">Convert Body To</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="correlation-identifier.html">Correlation Identifier</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dead-letter-channel.html">Dead Letter Channel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="delay-eip.html">Delay</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="durable-subscriber.html">Durable Subscriber</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dynamicRouter-eip.html">Dynamic Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="enrich-eip.html">Enrich</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eventDrivenConsumer-eip.html">Event Driven Consumer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="event-message.html">Event Message</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="filter-eip.html">Filter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="from-eip.html">From</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guaranteed-delivery.html">Guaranteed Delivery</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="idempotentConsumer-eip.html">Idempotent Consumer</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="intercept.html">Intercept</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kamelet-eip.html">Kamelet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="loadBalance-eip.html">Load Balance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="log-eip.html">Log</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="loop-eip.html">Loop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="marshal-eip.html">Marshal</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message.html">Message</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-broker.html">Message Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-bus.html">Message Bus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-channel.html">Message Channel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-dispatcher.html">Message Dispatcher</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-endpoint.html">Message Endpoint</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-expiration.html">Message Expiration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-history.html">Message History</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-router.html">Message Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-translator.html">Message Translator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="messaging-bridge.html">Messaging Bridge</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="messaging-gateway.html">Messaging Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="messaging-mapper.html">Messaging Mapper</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="multicast-eip.html">Multicast</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="normalizer.html">Normalizer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pipeline-eip.html">Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="point-to-point-channel.html">Point to Point Channel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pollEnrich-eip.html">Poll Enrich</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="polling-consumer.html">Polling Consumer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="process-eip.html">Process</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="process-manager.html">Process Manager</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="publish-subscribe-channel.html">Publish Subscribe Channel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="recipientList-eip.html">Recipient List</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="removeHeader-eip.html">Remove Header</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="removeHeaders-eip.html">Remove Headers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="removeProperties-eip.html">Remove Properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="removeProperty-eip.html">Remove Property</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="requestReply-eip.html">Request Reply</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resequence-eip.html">Resequence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resilience4j-eip.html">Resilience4j Circuit Breaker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="return-address.html">Return Address</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rollback-eip.html">Rollback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="routingSlip-eip.html">Routing Slip</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="saga-eip.html">Saga</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sample-eip.html">Sample</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scatter-gather.html">Scatter Gather</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="script-eip.html">Script</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="selective-consumer.html">Selective Consumer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="service-activator.html">Service Activator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="serviceCall-eip.html">Service Call</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setBody-eip.html">Set Body</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setHeader-eip.html">Set Header</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setProperty-eip.html">Set Property</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sort-eip.html">Sort</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="split-eip.html">Split</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="step-eip.html">Step</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stop-eip.html">Stop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="threads-eip.html">Threads</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="throttle-eip.html">Throttle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="to-eip.html">To</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="toD-eip.html">To Dynamic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="transactional-client.html">Transactional Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="transform-eip.html">Transform</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="unmarshal-eip.html">Unmarshal</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="validate-eip.html">Validate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="wireTap-eip.html">Wire Tap</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Camel Components</span>
    <span class="version">4.0.x</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../../4.10.x/index.html">Camel Components</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../4.10.x/index.html">4.10.x (LTS)</a>
        </li>
        <li class="version">
          <a href="../../4.8.x/index.html">4.8.x</a>
        </li>
        <li class="version">
          <a href="../../4.4.x/index.html">4.4.x</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">4.0.x</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../manual/4.10.x/index.html">User manual</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../manual/4.10.x/index.html">4.10.x</a>
        </li>
        <li class="version">
          <a href="../../../manual/4.8.x/index.html">4.8.x</a>
        </li>
        <li class="version">
          <a href="../../../manual/4.4.x/index.html">4.4.x</a>
        </li>
        <li class="version">
          <a href="../../../manual/4.0.x/index.html">4.0.x</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../manual/4.10.x/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Camel Components</a></li>
    <li><a href="enterprise-integration-patterns.html">Enterprise Integration Patterns</a></li>
    <li><a href="intercept.html">Intercept</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">4.0.x</button>
  <div class="version-menu">
    <a class="version" href="../../4.10.x/eips/intercept.html">4.10.x (LTS)</a>
    <a class="version" href="../../4.8.x/eips/intercept.html">4.8.x</a>
    <a class="version" href="../../4.4.x/eips/intercept.html">4.4.x</a>
    <a class="version is-current" href="intercept.html">4.0.x</a>
  </div>
</div>

</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Intercept</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The intercept feature in Camel supports intercepting
<a href="../../../manual/4.10.x/exchange.html" class="xref page">Exchange</a>'s' while they are being routed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kinds_of_interceptors"><a class="anchor" href="#_kinds_of_interceptors"></a>Kinds of interceptors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Camel supports three kinds of interceptors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>intercept</code> that intercepts every processing step as they happen during routing</p>
</li>
<li>
<p><code>interceptFrom</code> that intercepts only the incoming step (i.e. <a href="from-eip.html" class="xref page">from</a>)</p>
</li>
<li>
<p><code>interceptSendToEndpoint</code> that intercepts only when an
<a href="../../../manual/4.10.x/exchange.html" class="xref page">Exchange</a> is about to be sent to the given <a href="message-endpoint.html" class="xref page">endpoint</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>interceptSendToEndpoint</code> is dynamic hence it will also trigger if a
dynamic URI is constructed that Camel was not aware of at startup
time.</p>
</div>
<div class="paragraph">
<p>The <code>interceptFrom</code> is not dynamic, and will only intercept
all the known routes when Camel is starting.
So if you construct a <code>Consumer</code> using the Camel Java API and consumes
messages from this endpoint, then the <code>interceptFrom</code> is not triggered.</p>
</div>
<div class="sect2">
<h3 id="_interceptor_scopes"><a class="anchor" href="#_interceptor_scopes"></a>Interceptor scopes</h3>
<div class="paragraph">
<p>All the interceptors can be configured on global, route scope, or with
<a href="../../../manual/4.10.x/route-configuration.html" class="xref page">Route Configuration</a>.</p>
</div>
<div class="paragraph">
<p>This means multiple interceptors can be <em>triggered</em>.</p>
</div>
<div class="paragraph">
<p>Most of the examples in this page are on global scope.
To use route scope, then it is similar, but it is done on the route as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("jms:queue:order")
   .intercept().to("log:hello").end() // intercepts only in this route
  .to("bean:validateOrder")
  .to("bean:processOrder");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;intercept&gt;
      &lt;to uri="log:hello"/&gt;
    &lt;/intercept&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
  &lt;/route&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_common_features_of_the_interceptors"><a class="anchor" href="#_common_features_of_the_interceptors"></a>Common features of the interceptors</h3>
<div class="paragraph">
<p>All these interceptors support the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../../manual/4.10.x/predicate.html" class="xref page">Predicate</a> using <code>when</code> to only trigger the interceptor in certain conditions</p>
</li>
<li>
<p><code>stop</code> forces stopping continue routing the Exchange and mark it as completed successful (it&#8217;s actually the <a href="stop-eip.html" class="xref page">Stop</a> EIP).</p>
</li>
<li>
<p><code>skip</code> when used with <code>interceptSendToEndpoint</code> will <strong>skip</strong> sending the message to the original intended endpoint.</p>
</li>
<li>
<p><code>afterUri</code> when used with <code>interceptSendToEndpoint</code> allows to send
the message to an <a href="message-endpoint.html" class="xref page">endpoint</a> afterwards.</p>
</li>
<li>
<p><code>interceptFrom</code> and <code>interceptSendToEndpoint</code> support endpoint
URI pattern matching by exact uri, wildcard and regular expression. See further below for more details.</p>
</li>
<li>
<p>The intercepted endpoint uri is stored as message header with the key
<code>Exchange.INTERCEPTED_ENDPOINT</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_using_intercept"><a class="anchor" href="#_using_intercept"></a>Using intercept</h3>
<div class="paragraph">
<p>The <code>Intercept</code> is intercepting the <a href="../../../manual/4.10.x/exchange.html" class="xref page">Exchange</a>
on every processing steps during routing.</p>
</div>
<div class="paragraph">
<p>Given the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// global interceptor for all routes
intercept().to("log:hello");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder");</code></pre>
</div>
</div>
<div class="paragraph">
<p>What happens is that the <code>Exchange</code> is intercepted
before each processing step, that means that it will be intercepted
before</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.to("bean:validateOrder")</code></p>
</li>
<li>
<p><code>.to("bean:processOrder")</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So in this example we intercept the <code>Exchange</code> twice.</p>
</div>
<div class="paragraph">
<p>The example is as follows in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;!-- global interceptor for all routes --&gt;
  &lt;intercept&gt;
    &lt;to uri="log:hello"/&gt;
  &lt;/intercept&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controlling_when_to_intercept_using_a_predicate"><a class="anchor" href="#_controlling_when_to_intercept_using_a_predicate"></a>Controlling when to intercept using a predicate</h3>
<div class="paragraph">
<p>If you only want to intercept "sometimes", then you can use a <a href="../../../manual/4.10.x/predicate.html" class="xref page">predicate</a>.</p>
</div>
<div class="paragraph">
<p>For instance in the sample below we only intercept if the message body
contains the string word Hello:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">intercept().when(body().contains("Hello")).to("mock:intercepted");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;intercept&gt;
      &lt;when&gt;
          &lt;simple&gt;${in.body} contains 'Hello'&lt;/simple&gt;
      &lt;/when&gt;
      &lt;to uri="mock:intercepted"/&gt;
  &lt;/intercept&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stop_routing_after_being_intercepted"><a class="anchor" href="#_stop_routing_after_being_intercepted"></a>Stop routing after being intercepted</h3>
<div class="paragraph">
<p>It is also possible to stop continue routing after being intercepted.
Now suppose that if the message body contains the word Hello we want to log and stop, then we can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">intercept().when(body().contains("Hello"))
  .to("log:test")
  .stop(); // stop continue routing

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;intercept&gt;
      &lt;when&gt;
        &lt;simple&gt;${body} contains 'Hello'&lt;/simple&gt;
        &lt;to uri="log:test"/&gt;
        &lt;stop/&gt; &lt;!-- stop continue routing --&gt;
      &lt;/when&gt;
  &lt;/intercept&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_intercept_from"><a class="anchor" href="#_using_intercept_from"></a>Using intercept from</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>interceptFrom</code> is for intercepting any incoming
Exchange, in any route (it intercepts all the <a href="from-eip.html" class="xref page">from</a> EIPs)</p>
</div>
<div class="paragraph">
<p>This allows you to do some custom behavior for received Exchanges.
You can provide a specific uri for a given Endpoint then it only
applies for that particular route.</p>
</div>
<div class="paragraph">
<p>So lets start with the logging example. We want to log all the
incoming messages, so we use <code>interceptFrom</code> to route to the
<a href="#ROOT:log-component.adoc" class="xref unresolved">Log</a> component.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptFrom()
  .to("log:incoming");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;intercept&gt;
    &lt;to uri="log:incoming"/&gt;
  &lt;/intercept&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to only apply a specific endpoint, such as all jms endpoints,
you can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptFrom("jms*")
  .to("log:incoming");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder");

from("file:inbox")
  .to("ftp:someserver/backup")</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example then only messages from the JMS route are intercepted, because
we specified a pattern in the <code>interceptFrom</code> as <code>jms*</code> (uses a wildcard).</p>
</div>
<div class="paragraph">
<p>The pattern syntax is documented in more details later.</p>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;interceptFrom uri="jms*"&gt;
    &lt;to uri="log:incoming"/&gt;
  &lt;/intercept&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
  &lt;/route&gt;
  &lt;route&gt;
    &lt;from uri="file:inbox"/&gt;
    &lt;to uri="ftp:someserver/backup"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_intercept_when_sending_to_an_endpoint"><a class="anchor" href="#_using_intercept_when_sending_to_an_endpoint"></a>Using intercept when sending to an endpoint</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also intercept when Camel is sending a message to an <a href="message-endpoint.html" class="xref page">endpoint</a>.</p>
</div>
<div class="paragraph">
<p>This can be used to do some custom processing before the
message is sent to the intended destination.</p>
</div>
<div class="paragraph">
<p>The interceptor can also be configured to not send to the destination (skip)
which means the message is detoured instead.</p>
</div>
<div class="paragraph">
<p>A <a href="../../../manual/4.10.x/predicate.html" class="xref page">Predicate</a> can also be used
to control when to intercept, which has been previously covered.</p>
</div>
<div class="paragraph">
<p>The <code>afterUri</code> option, is used when you need to process
the response message from the intended destination. This functionality
was added later to the interceptor, in a form of sending to yet another <a href="message-endpoint.html" class="xref page">endpoint</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a basic example, where we want to intercept when a
message is being sent to <a href="#ROOT:kafka-component.adoc" class="xref unresolved">kafka</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptSendToEndpoint("kafka*")
  .to("bean:beforeKafka");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder")
  .to("kafka:order");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;interceptSendToEndpoint uri="kafka*"&gt;
    &lt;to uri="bean:beforeKafka"/&gt;
  &lt;/interceptSendToEndpoint&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
    &lt;to uri="kafka:order"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you also want to process the message after it has been sent to the intended destination,
then the example is slightly <em>odd</em> because you have to use the <code>afterUri</code> as shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptSendToEndpoint("kafka*")
  .to("bean:beforeKafka")
  .afterUri("bean:afterKafka");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder")
  .to("kafka:order");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;interceptSendToEndpoint uri="kafka*" afterUri="bean:afterKafka"&gt;
    &lt;to uri="bean:beforeKafka"/&gt;
  &lt;/interceptSendToEndpoint&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
    &lt;to uri="kafka:order"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_skip_sending_to_original_endpoint"><a class="anchor" href="#_skip_sending_to_original_endpoint"></a>Skip sending to original endpoint</h3>
<div class="paragraph">
<p>Sometimes you want to <strong>intercept and skip</strong> sending messages to a specific endpoint.</p>
</div>
<div class="paragraph">
<p>For example to avoid sending any message to kafka, but detour them to a
<a href="#ROOT:mock-component.adoc" class="xref unresolved">mock</a> endpoint, it can be done as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptSendToEndpoint("kafka*").skipSendToOriginalEndpoint()
  .to("mock:kafka");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder")
  .to("kafka:order");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;interceptSendToEndpoint uri="kafka*" skipSendToOriginalEndpoint="true"&gt;
    &lt;to uri="mock:kafka"/&gt;
  &lt;/interceptSendToEndpoint&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
    &lt;to uri="kafka:order"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conditional_skipping_sending_to_endpoint"><a class="anchor" href="#_conditional_skipping_sending_to_endpoint"></a>Conditional skipping sending to endpoint</h3>
<div class="paragraph">
<p>You can combine both a <a href="../../../manual/4.10.x/predicate.html" class="xref page">predicate</a> and skip sending to the original endpoint.
For example suppose you have some "test" messages that sometimes occur, and that you
want to avoid sending these messages to a downstream kafka system, then this can be done as shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptSendToEndpoint("kafka*").skipSendToOriginalEndpoint()
  .when(simple("${header.biztype} == 'TEST'")
  .log("TEST message detected - is NOT send to kafka");

from("jms:queue:order")
  .to("bean:validateOrder")
  .to("bean:processOrder")
  .to("kafka:order");</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext&gt;

  &lt;interceptSendToEndpoint uri="kafka*" skipSendToOriginalEndpoint="true"&gt;
    &lt;when&gt;&lt;simple&gt;${header.biztype} == 'TEST'&lt;/simple&gt;&lt;/when&gt;
    &lt;log message="TEST message detected - is NOT send to kafka"/&gt;
  &lt;/interceptSendToEndpoint&gt;

  &lt;route&gt;
    &lt;from uri="jms:queue:order"/&gt;
    &lt;to uri="bean:validateOrder"/&gt;
    &lt;to uri="bean:processOrder"/&gt;
    &lt;to uri="kafka:order"/&gt;
  &lt;/route&gt;

&lt;/camelContext&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_intercepting_endpoints_using_pattern_matching"><a class="anchor" href="#_intercepting_endpoints_using_pattern_matching"></a>Intercepting endpoints using pattern matching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>interceptFrom</code> and <code>interceptSendToEndpoint</code> support endpoint pattern
matching by the following rules in the given order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>match by exact URI name</p>
</li>
<li>
<p>match by wildcard</p>
</li>
<li>
<p>match by regular expression</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_intercepting_when_matching_by_exact_uri"><a class="anchor" href="#_intercepting_when_matching_by_exact_uri"></a>Intercepting when matching by exact URI</h3>
<div class="paragraph">
<p>This matches only a specific endpoint with exactly the same URI.</p>
</div>
<div class="paragraph">
<p>For example to intercept messages being sent to a specific JMS queue you can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptSendToEndpoint("jms:queue:cheese").to("log:smelly");</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_intercepting_when_matching_endpoints_by_wildcard"><a class="anchor" href="#_intercepting_when_matching_endpoints_by_wildcard"></a>Intercepting when matching endpoints by wildcard</h3>
<div class="paragraph">
<p>Match by wildcard allows you to match a range of endpoints or all of a
given type. For instance use <code>file:*</code> will match all <a href="#ROOT:file-component.adoc" class="xref unresolved">file</a> based endpoints.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptFrom("file:*").to("log:from-file");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Match by wildcard works so that the pattern ends with a <code>\*</code> and that
the uri matches if it starts with the same pattern.</p>
</div>
<div class="paragraph">
<p>For example, you can be more specific, to only match for files
from specific folders like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptFrom("file:order/inbox/*").to("log:new-file-orders");</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_intercepting_when_matching_endpoints_by_regular_expression"><a class="anchor" href="#_intercepting_when_matching_endpoints_by_regular_expression"></a>Intercepting when matching endpoints by regular expression</h3>
<div class="paragraph">
<p>Match by regular expression is just like match by wildcard but using
regex instead. So if we want to intercept incoming messages from gold
and silver JMS queues we can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interceptFrom("jms:queue:(gold|silver)").to("seda:handleFast");</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>

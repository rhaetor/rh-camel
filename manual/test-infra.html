<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Test Infrastructure :: Red Hat Integration</title>
    <meta name="generator" content="Antora 3.0.3">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Red Hat Integration</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="manual" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">User manual</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="getting-started.html">Getting started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="what-are-the-dependencies.html">What are the dependencies?</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources &amp; Guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="/community/books/">Books</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="building.html">Building</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-console.html">Camel Developer Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-jbang.html">Camel JBang</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-maven-plugin.html">Camel Maven Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-component-maven-plugin.html">Camel Component Maven Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-report-maven-plugin.html">Camel Maven Report Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-maven-archetypes.html">Camel Maven Archetypes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuring-route-startup-ordering-and-autostartup.html">Configuring route startup ordering and autostartup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="component-dsl.html">Component DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Endpoint-dsl.html">Endpoint DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dataformat-dsl.html">DataFormat DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="examples.html">Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="graceful-shutdown.html">Graceful Shutdown</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="error-handler.html">Error handler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="using-propertyplaceholder.html">How to use Camel property placeholders</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="testing.html">Testing</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="test-infra.html">Test Infra</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="notify-builder.html">NotifyBuilder</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="advice-with.html">AdviceWith</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rest-dsl.html">Working with REST and Rest DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="writing-components.html">Writing Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="release-guide.html">Release guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="release-guide-website.html">Adding doc versions to the website</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="improving-the-documentation.html">Improving the Documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="migration-and-upgrade.html">Migration and Upgrade</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-3-migration-guide.html">Camel 2.x to 3.0 Migration Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-3x-upgrade-guide.html">Camel 3.x Upgrade Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-4-migration-guide.html">Camel 3.x to 4.0 Migration Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camel-4x-upgrade-guide.html">Camel 4.x Upgrade Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="architecture.html">Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backlog-debugger.html">Backlog debugger</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backlog-tracer.html">Backlog Tracer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="batch-consumer.html">Batch Consumer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bean-binding.html">Bean Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bean-integration.html">Bean Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camelcontext.html">CamelContext</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="camelcontext-autoconfigure.html">CamelContext Auto Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="clustering.html">Clustering and Load Balancing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="component.html">Component</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="data-format.html">Data Format</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="debugger.html">Debugger</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="delay-interceptor.html">Delayer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endpoint.html">Endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endpoint-annotations.html">Endpoint Annotations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exception-clause.html">Exception Clause</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exchange-pooling.html">Exchange Pooling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http-session-handling.html">HTTP-Session Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parameter-binding-annotations.html">Parameter Binding Annotations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pojo-producing.html">POJO Producing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pojo-consuming.html">POJO Consuming</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="producertemplate.html">ProducerTemplate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="consumertemplate.html">ConsumerTemplate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="error-handler.html">Error Handler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exchange.html">Message Exchange</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="using-exchange-pattern-annotations.html">Using Exchange pattern annotations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="expression.html">Expressions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/next/eips/content-enricher.html">Content Enrichment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="injector.html">Injector</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../components/next/eips/intercept.html">Intercept</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jmx.html">JMX</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lifecycle.html">Camel Lifecycle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="oncompletion.html">OnCompletion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pluggable-class-resolvers.html">Pluggable Class Resolvers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="predicate.html">Predicates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="processor.html">Processor</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="registry.html">Registry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-builder.html">RouteBuilder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lambda-route-builder.html">LambdaRouteBuilder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-controller.html">RouteController</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-policy.html">RoutePolicy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-configuration.html">RouteConfiguration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="context-reload.html">ContextReload</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-reload.html">RouteReload</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="route-template.html">RouteTemplate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="routes.html">Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stream-caching.html">Stream caching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="transformer.html">Transformer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="threading-model.html">Threading Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tracer.html">Tracer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="type-converter.html">Type Converter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="uris.html">URIs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="uuidgenerator.html">UuidGenerator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="validator.html">Validator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="health-check.html">Health Checks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Domain Specific Languages</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl.html">Camel Domain Specific Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="languages.html">Languages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="java-dsl.html">Java DSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="spring.html">Spring support</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="faq/index.html">FAQ</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/can-i-get-commercial-support.html">Can I get commercial support?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="/community/support/">How can I get help?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-get-the-source-code.html">How can I get the source code?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-does-camel-work.html">How does Camel work?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-does-the-website-work.html">How does the website work?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-become-a-committer.html">How do I become a committer?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-compile-the-code.html">How do I compile the code?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-edit-the-website.html">How do I edit the website?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/running-camel-standalone.html">Running Camel standalone</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-is-a-router.html">What is a router?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-is-camel.html">What is Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-is-the-license.html">What is the license?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="languages.html">What languages are supported?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/what-platforms-are-supported.html">What platforms are supported?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-the-name-camel.html">Why the name Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-specify-which-method-to-use-when-using-beans-in-routes.html">How do I specify which method to use when using beans in routes?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-create-a-custom-component-or-endpoint.html">How can I create a custom component or endpoint?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-get-the-remote-connection-ip-address-from-the-camel-cxf-consumer-.html">How can I get the remote connection IP address from the camel-cxf consumer ?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-i-stop-a-route-from-a-route.html">How can I stop a route from a route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-can-webservice-clients-see-remote-faults-with-stacktraces-when-using-camel-cxf.html">How can webservice clients see remote faults with stacktraces when using camel-cxf?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-does-camel-look-up-beans-and-endpoints.html">How does Camel look up beans and endpoints?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-change-the-logging.html">How do I change the logging?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-endpoints.html">How do I configure endpoints?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-password-options-on-camel-endpoints-without-the-value-being-encoded.html">How do I configure password options on Camel endpoints without the value being encoded?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-the-default-maximum-cache-size-for-producercache-or-producertemplate.html">How do I configure the default maximum cache size for ProducerCache or ProducerTemplate?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-configure-the-maximum-endpoint-cache-size-for-camelcontext.html">How do I configure the maximum endpoint cache size for CamelContext?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-debug-my-route.html">How do I debug my route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-disable-jmx.html">How do I disable JMX?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-enable-streams-when-debug-logging-messages-in-camel.html">How do I enable streams when debug logging messages in Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-handle-failures-when-consuming-for-example-from-a-ftp-server.html">How do I handle failures when consuming for example from a FTP server?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-import-rests-from-other-xml-files.html">How do I import rests from other XML files?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-import-routes-from-other-xml-files.html">How do I import routes from other XML files?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-let-jetty-match-wildcards.html">How do I let Jetty match wildcards?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-name-my-routes.html">How do I name my routes?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-restart-camelcontext.html">How do I restart CamelContext?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-retrieve-the-thrown-exception-during-processing-an-exchange.html">How do I retrieve the thrown Exception during processing an Exchange?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-retry-failed-messages-forever.html">How do I retry failed messages forever?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-retry-processing-a-message-from-a-certain-point-back-or-an-entire-route.html">How do I retry processing a message from a certain point back or an entire route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-reuse-the-contexttestsupport-class-in-my-unit-tests.html">How do I reuse the ContextTestSupport class in my unit tests?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-set-the-max-chars-when-debug-logging-messages-in-camel.html">How do I set the max chars when debug logging messages in Camel?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-use-uris-with-parameters-in-xml.html">How do I use URIs with parameters in XML?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-write-a-custom-processor-which-sends-multiple-messages.html">How do I write a custom Processor which sends multiple messages?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-should-i-invoke-my-pojos-or-spring-services.html">How should I invoke my POJOs or Spring Services?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-avoid-importing-bunch-of-cxf-packages-when-start-up-the-camel-cxf-endpoint-from-osgi-platform-.html">How to avoid importing bunch of cxf packages when start up the camel-cxf endpoint from OSGi platform?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-avoid-sending-some-or-all-message-headers.html">How to avoid sending some or all message headers?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-remove-the-http-protocol-headers-in-the-camel-message.html">How to remove the http protocol headers in the camel message?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-send-the-same-message-to-multiple-endpoints.html">How to send the same message to multiple endpoints?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-switch-the-cxf-consumer-between-http-and-https-without-touching-the-spring-configuration.html">How to switch the CXF consumer between HTTP and HTTPS without touching the Spring configuration?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-to-use-a-dynamic-uri-in-to.html">How to use a dynamic URI in to()?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/is-there-an-ide.html">Is there an IDE?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/using-getin-or-getout-methods-on-exchange.html">Using getIn or getOut methods on Exchange</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-cant-i-use-sign-in-my-password.html">Why can&#8217;t I use + sign in my password?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-can-i-not-use-when-or-otherwise-in-a-java-camel-route.html">Why can I not use when or otherwise in a Java Camel route?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-ftp-component-not-download-any-files.html">Why does FTP component not download any files?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-my-file-consumer-not-pick-up-the-file-and-how-do-i-let-the-file-consumer-use-the-camel-error-handler.html">Why does my file consumer not pick up the file, and how do I let the file consumer use the Camel error handler?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-useoriginalmessage-with-error-handler-not-work-as-expected.html">Why does useOriginalMessage with error handler not work as expected?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-do-my-message-lose-its-headers-during-routing.html">Why do my message lose its headers during routing?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-is-my-message-body-empty.html">Why is my message body empty?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-is-my-processor-not-showing-up-in-jconsole.html">Why is my processor not showing up in JConsole?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-is-the-exception-null-when-i-use-onexception.html">Why is the exception null when I use onException?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-use-multiple-camelcontext.html">Why use multiple CamelContext?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-enable-debug-logging.html">How do I enable debug logging?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-use-log4j.html">How do I use log4j?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-make-my-jms-endpoint-transactional.html">How Do I Make My JMS Endpoint Transactional?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-i-set-the-mep-when-interacting-with-jbi.html">How do I set the MEP when interacting with JBI?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-the-direct-event-seda-and-vm-endpoints-compare.html">How do the direct, event, seda and vm endpoints compare?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/how-do-the-timer-and-quartz-endpoints-compare.html">How do the Timer and Quartz endpoints compare?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-my-jms-route-only-consume-one-message-at-once.html">Why does my JMS route only consume one message at once?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/exception-beandefinitionstoreexception.html">Exception - BeanDefinitionStoreException</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/exception-orgapachecamelnosuchendpointexception.html">Exception - org.apache.camel.NoSuchEndpointException</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/exception-orgxmlsaxsaxparseexception.html">Exception - org.xml.sax.SAXParseException</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/memory-leak-when-adding-and-removing-routes-at-runtime.html">Memory leak when adding and removing routes at runtime</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-camel-use-too-many-threads-with-producertemplate.html">Why does Camel use too many threads with ProducerTemplate?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq/why-does-maven-not-download-dependencies.html">Why does maven not download dependencies?</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><strong>Reference</strong></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/next/index.html">Components</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/next/dataformats/index.html">Data Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/next/languages/index.html">Languages</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../components/next/eips/enterprise-integration-patterns.html">EIPs</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">User manual</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../components/next/index.html">Camel Components</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../components/next/index.html">Next (Pre-release)</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">User manual</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">User manual</a></li>
    <li>Resources &amp; Guides</li>
    <li><a href="testing.html">Testing</a></li>
    <li><a href="test-infra.html">Test Infra</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///code/jboss/jboss-camel/docs/user-manual/modules/ROOT/pages/test-infra.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Test Infrastructure</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The components in the Camel Test Infra provide utilities to simplify testing with Camel and other systems may interact with it. They work as JUnit 5 extensions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_the_camel_context_in_tests"><a class="anchor" href="#_working_with_the_camel_context_in_tests"></a>Working with the Camel Context in Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When testing Camel or a Camel-based integration, you almost certainly need to use the <code>CamelContext</code> to configure the registry, add routes and execute other operations. The test infra comes with a module that provides a JUnit 5 extension that allows you to inject a Camel context into your tests.</p>
</div>
<div class="paragraph">
<p>Adding it to your test code is as simple as adding the following lines of code to your test class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterExtension
protected static CamelContextExtension contextExtension = new DefaultCamelContextExtension();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, via the extension, you can access the context (ie.: <code>``contextExtension.getContext()</code>) to manipulate it as need in the tests.</p>
</div>
<div class="paragraph">
<p>The extension comes with a few utilities to simplify configuring the context, and adding routes at the appropriate time.</p>
</div>
<div class="sect2">
<h3 id="_configuring_the_camel_context"><a class="anchor" href="#_configuring_the_camel_context"></a>Configuring the Camel Context</h3>
<div class="paragraph">
<p>To create a method that configures the context, you can declare a method receiving an instance of <code>CamelContext</code> and annotate it with <code>@ContextFixture</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ContextFixture
public void configureContext(CamelContext context) {
   // context configuration code here
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, you can simplify the class hierarchy, and ensure consistency you may also implement the <code>ConfigurableContext</code> interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_the_routes"><a class="anchor" href="#_configuring_the_routes"></a>Configuring the Routes</h3>
<div class="paragraph">
<p>You can configure the routes using a similar process as the one described for configuring the Camel context. You can create a method that receives an instance of <code>CamelContext</code> and annotate it with <code>@RouteFixture</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RouteFixture
public void createRouteBuilder(CamelContext context) throws Exception {
    context.addRoutes(new RouteBuilder() {
        @Override
        public void configure() {
           from(fromUri).to(destUri);
        }
    });
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_the_camel_context_extension"><a class="anchor" href="#_use_the_camel_context_extension"></a>Use the Camel Context Extension</h3>
<div class="paragraph">
<p>To start using the Camel Context extension on your code, add the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-test-infra-core&lt;/artifactId&gt;
    &lt;version&gt;${camel.version}&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
    &lt;type&gt;test-jar&lt;/type&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For simplicity and consistency, you may also declare the route as implementing the <code>ConfigurableRoute</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_simulating_the_test_infrastructure"><a class="anchor" href="#_simulating_the_test_infrastructure"></a>Simulating the Test Infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the first steps when implementing a new test, is to identify how to simulate infrastructure required for it to
run. The test-infra module provides a reusable library of infrastructure that can be used for that purpose.</p>
</div>
<div class="paragraph">
<p>In general, the integration test leverages the features provided by the project <a href="https://www.testcontainers.org/">TestContainers</a>
and uses container images to simulate the environments. Additionally, it may also support running the tests against remote
environments as well as, when available, embeddable components. This varies by each component, and it is recommended to
check the code for additional details.</p>
</div>
<div class="sect2">
<h3 id="_writing_a_new_test_infrastructure_module"><a class="anchor" href="#_writing_a_new_test_infrastructure_module"></a>Writing A New Test Infrastructure Module</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This section is aimed at Camel maintainers that need to write new test infra components. End users can skip this section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The test code abstracts the provisioning of test environments behind service classes (i.e.: JMSService, JDBCService,
etc). The purpose of the service class is to abstract the both the type service (i.e.: Kafka, Strimzi, etc) and
the location of the service (i.e.: remote, local, embedded, etc). This provides flexibility to test the code under
different circumstances (i.e.: using a remote JMS broker or using a local JMS broker running in a container managed by
TestContainers). It makes it easier to hit edge cases as well as try different operating scenarios (i.e.: higher
latency, slow backends, etc).</p>
</div>
<div class="paragraph">
<p>JUnit 5 manages the lifecycle of the services, therefore each service must be a JUnit 5 compliant extension. The exact
extension point that a service must extend is specific to each service. The JUnit 5
<a href="https://junit.org/junit5/docs/current/user-guide">documentation</a> is the reference for the extension points.</p>
</div>
<div class="paragraph">
<p>When a container image is not available via TestContainers, tests can provide their own implementation using officially
available images. The license must be compatible with Apache 2.0. If an official image is not available, a Dockerfile
to build the service can be provided. The Dockerfile should try to minimize the container size and resource usage
whenever possible.</p>
</div>
<div class="paragraph">
<p>It is also possible to use embeddable components when required, although this usually lead to more code and higher
maintenance.</p>
</div>
<div class="sect3">
<h4 id="_recommended_structure_for_test_infrastructure_modules"><a class="anchor" href="#_recommended_structure_for_test_infrastructure_modules"></a>Recommended Structure for Test Infrastructure Modules</h4>
<div class="paragraph">
<p>The service should provide an interface, named after the infrastructure being implemented, and this interface should
extend the <a href="https://github.com/apache/camel/blob/main/test-infra/camel-test-infra-common/src/test/java/org/apache/camel/test/infra/common/services/TestService.java">TestService</a>
interface. The services should try to minimize the test execution time and resource usage when running. As such,
the <a href="https://junit.org/junit5/docs/5.1.1/api/org/junit/jupiter/api/extension/BeforeAllCallback.html">BeforeAllCallback</a>
and <a href="https://junit.org/junit5/docs/5.1.1/api/org/junit/jupiter/api/extension/AfterAllCallback.html">AfterAllCallback</a>
should be the preferred extensions whenever possible because they allow the instance of the infrastructure to be static
throughout the test execution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Bear in mind that, according to the <a href="https://junit.org/junit5/docs/5.1.1/api/org/junit/jupiter/api/extension/RegisterExtension.html">JUnit 5 extension</a>
model, the time of initialization of the service may differ depending on whether the service instance is declared as
static or not in the test class. As such, the code should make no assumptions as to its time of initialization.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ideally, there should be two concrete implementations of the services: one of the remote service (if applicable) and
another for the container service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">              MyService
                 / \
                /   \
               /     \
 MyRemoteService    MyContainerService</code></pre>
</div>
</div>
<div class="paragraph">
<p>In most cases a specialized service factory class is responsible for creating the service according to runtime
parameters and/or other test scenarios constraints. When a service allows different service types or locations to be
selected, this should be done via command line properties (<code>-D&lt;property.name&gt;=&lt;value&gt;</code>). For example, when allowing a
service to choose between running as a local container or as remote instance, a property in the format
<code>&lt;name&gt;.instance.type</code> should be handled. Additional runtime parameters used in different scenarios, should be handled
as <code>&lt;name&gt;.&lt;parameter&gt;</code>. More complex services may use the builder available through the factory classes to compose
the service accordingly.</p>
</div>
</div>
<div class="sect3">
<h4 id="_registering_properties"><a class="anchor" href="#_registering_properties"></a>Registering Properties</h4>
<div class="paragraph">
<p>All services should register the properties, via <code>System.setProperty</code> that allow access to the services. This is required
in order to resolve those properties when running tests using the Spring framework. This registration allows the properties
to be resolved in Spring&#8217;s XML files.</p>
</div>
<div class="paragraph">
<p>This registration is done in the <code>registerProperties</code> methods during the service initialization.</p>
</div>
</div>
<div class="sect3">
<h4 id="_registering_properties_example"><a class="anchor" href="#_registering_properties_example"></a>Registering Properties Example:</h4>
<div class="paragraph">
<p>Registering the properties in the concrete service implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    public void registerProperties() {
        // MyServiceProperties.MY_SERVICE_HOST is a string with value "my.service.host"
        System.setProperty(MyServiceProperties.MY_SERVICE_HOST, container.getHost());

        // MyServiceProperties.MY_SERVICE_PORT is a string with value "my.service.port"
        System.setProperty(MyServiceProperties.MY_SERVICE_PORT, String.valueOf(container.getServicePort()));

        // MyServiceProperties.MY_SERVICE_ADDRESS is a string with value "my.service.address"
        System.setProperty(MyServiceProperties.MY_SERVICE_ADDRESS, getServiceAddress());
    }

    public void initialize() {
        LOG.info("Trying to start the MyService container");
        container.start();

        registerProperties();
        LOG.info("MyService instance running at {}", getServiceAddress());
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, when referring these properties in Camel routes or Spring XML properties, you may use <code>{{my.service.host}}</code>,
<code>{{my.service.port}}</code> and <code>{{my.service.address}}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_packaging_recommendations"><a class="anchor" href="#_packaging_recommendations"></a>Packaging Recommendations</h4>
<div class="paragraph">
<p>This is test infrastructure code, therefore it should be package as test type artifacts. The
<a href="https://github.com/apache/camel/blob/main/test-infra/camel-test-infra-parent">parent pom</a> should provide all the necessary bits for packaging the test infrastructure.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_new_test_infrastructure"><a class="anchor" href="#_using_the_new_test_infrastructure"></a>Using The New Test Infrastructure</h3>
<div class="paragraph">
<p>Using the test infra in a new component test is rather straightforward, similar to using any other reusable component.
You start by declaring the test infra dependencies in your pom file.</p>
</div>
<div class="paragraph">
<p>This should be similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- test infra --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-test-infra-myservice&lt;/artifactId&gt;
    &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;type&gt;test-jar&lt;/type&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>On the dependencies above, the dependency version is set to <code>${project.version}</code>. This should be adjusted to the
Camel version when used outside the Camel Core project.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On the test class, add a member variable for the service and annotate it with the <a href="https://junit.org/junit5/docs/5.1.1/api/org/junit/jupiter/api/extension/RegisterExtension.html">@RegisterExtension</a>,
in order to let JUnit 5 manage its lifecycle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterExtension
static MyService service = MyServiceServiceFactory.createService();</code></pre>
</div>
</div>
<div class="paragraph">
<p>More complex test services can be created using something similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterExtension
static MyService service = MyServiceServiceFactory
    .builder()
        .addRemoveMapping(MyTestClass::myCustomRemoteService) // this is rarely needed
        .addLocalMapping(MyTestClass::staticMethodReturningAService) // sets the handler for -Dmy-service.instance.type=local-myservice-local-container
        .addMapping("local-alternative-service", MyTestClass::anotherMethodReturningAService) // sets the handler for -Dmy-service.instance.type=local-alternative-service
    .createService();</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the methods as well as the registered properties to access the test infrastructure services available.
When using these properties in Spring XML files, you may use those properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;someSpringXmlElement httpHost="{{my.service.host}}" port="{{my.service.port}}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to use these properties in the test code itself. For example, when setting up the test url for the
Camel component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    protected RouteBuilder createRouteBuilder() throws Exception {
        return new RouteBuilder() {
            public void configure() {
                from("direct:put")
                    .to("mycomponent:someoption?host={{my.service.host}}&amp;port={{my.service.port}}");
            }
        };
    }</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_execution_ordering"><a class="anchor" href="#_execution_ordering"></a>Execution Ordering</h4>
<div class="paragraph">
<p>When combining the different modules of the test infra, you may need to ensure that they execute in the proper order. You can do so by using JUnit&#8217;s <code>@Order</code> annotation.</p>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    @Order(1)
    @RegisterExtension
    protected static KafkaService service = KafkaServiceFactory.createSingletonService();

    @Order(2)
    @RegisterExtension
    protected static CamelContextExtension contextExtension = new DefaultCamelContextExtension();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_converting_camel_testcontainers_code_to_the_new_test_infrastructure"><a class="anchor" href="#_converting_camel_testcontainers_code_to_the_new_test_infrastructure"></a>Converting Camel TestContainers Code To The New Test Infrastructure</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This section is aimed at Camel maintainers that need to write new test infra components. End users can skip this section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using the camel-nats as an example, we can compare how the base test class for nats changed between <a href="https://github.com/apache/camel/blob/camel-3.6.0/components/camel-nats/src/test/java/org/apache/camel/component/nats/NatsTestSupport.java">3.6.x</a>
and <a href="https://github.com/apache/camel/blob/camel-3.7.0/components/camel-nats/src/test/java/org/apache/camel/component/nats/NatsTestSupport.java">3.7.x</a>.</p>
</div>
<div class="paragraph">
<p>The first conversion step is to remove the <a href="https://github.com/apache/camel/blob/camel-3.6.0/components/camel-nats/pom.xml#L59-L63">camel-testcontainer dependencies</a>
and replace them with the ones from the <a href="https://github.com/apache/camel/blob/camel-3.7.0/components/camel-nats/pom.xml#L61-L75">test-infra module</a>.
Then, it&#8217;s necessary to replace the <a href="https://github.com/apache/camel/blob/camel-3.6.0/components/camel-nats/src/test/java/org/apache/camel/component/nats/NatsTestSupport.java#L24-L45">container handling code and the old base class</a>
with the <a href="https://github.com/apache/camel/blob/camel-3.7.0/components/camel-nats/src/test/java/org/apache/camel/component/nats/NatsTestSupport.java#L26-L27">service provided in the module</a>.
Then, we replace the base class. The <code>ContainerAwareTestSupport</code> class and other similar classes from other
<code>camel-testcontainer</code> modules are not necessary and can be replaced with <code>CamelTestSupport</code> or the spring based one
<code>CamelSpringTestSupport</code>.</p>
</div>
<div class="paragraph">
<p>With the base changes in place, the next step is to make sure that addresses (URLs, hostnames, ports, etc) and
resources (usernames, passwords, tokens, etc) referenced during the test execution, use the test-infra services. This
may differ according to each service. Replacing the call to get the <a href="https://github.com/apache/camel/blob/camel-3.6.0/components/camel-nats/src/test/java/org/apache/camel/component/nats/NatsAuthConsumerLoadTest.java#L38">service URL</a>
with the one provided by the new <a href="https://github.com/apache/camel/blob/camel-3.7.0/components/camel-nats/src/test/java/org/apache/camel/component/nats/NatsAuthConsumerLoadTest.java#L38">test infra service</a>
is a good example of this type of changes that may be necessary.</p>
</div>
<div class="paragraph">
<p>In some cases, it may be necessary to adjust the variables used in <a href="https://github.com/apache/camel/blob/camel-3.6.0/components/camel-consul/src/test/resources/org/apache/camel/component/consul/cloud/SpringConsulRibbonServiceCallRouteTest.xml#L36">simple language</a>
so that they match the <a href="https://github.com/apache/camel/blob/camel-3.7.0/components/camel-consul/src/test/resources/org/apache/camel/component/consul/cloud/SpringConsulRibbonServiceCallRouteTest.xml#L36">new property format</a> used in the test infra service.</p>
</div>
<div class="paragraph">
<p>There are some cases where the container instance requires <a href="https://github.com/apache/camel/blob/camel-3.6.0/components/camel-pg-replication-slot/src/test/java/org/apache/camel/component/pg/replication/slot/integration/PgReplicationTestSupport.java#L31">extra customization</a>.
Nonetheless, the migrated code still benefits from the <a href="https://github.com/apache/camel/blob/camel-3.7.0/components/camel-pg-replication-slot/src/test/java/org/apache/camel/component/pg/replication/slot/integration/PgReplicationTestSupport.java#L31">test-infra approach</a>,
but this may be very specific to the test scenario.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_with_podman"><a class="anchor" href="#_running_with_podman"></a>Running With Podman</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most of the test infrastructure in this module is based on containers. Therefore, they will require a container runtime to run. Although the tests have been written and tested using Docker, they should also work with <a href="https://podman.io/">Podman</a> (another popular container runtime on Linux operating systems).</p>
</div>
<div class="paragraph">
<p>Assuming Podman is properly installed and configured to behave like docker (i.e.: short name resolution, resolving docker.io registry, etc), the only requirement for using Podman is to export the DOCKER_HOST variable before running the tests.</p>
</div>
<div class="sect2">
<h3 id="_linux"><a class="anchor" href="#_linux"></a>Linux</h3>
<div class="paragraph">
<p>On most systems that should be similar to the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">export DOCKER_HOST=unix:///run/user/$UID/podman/podman.sock</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_os_x_and_windows"><a class="anchor" href="#_os_x_and_windows"></a>OS X and Windows</h3>
<div class="paragraph">
<p>Running the test-infra with Podman on OS X and Windows should work on many cases. However, it requires additional steps and has a few issues. Therefore, it is not recommended at this time.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_known_issues_andor_tips"><a class="anchor" href="#_known_issues_andor_tips"></a>Known Issues and/or Tips</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_multi_architecture_support_arm"><a class="anchor" href="#_multi_architecture_support_arm"></a>Multi-architecture support: ARM</h3>
<div class="paragraph">
<p>Some containers don&#8217;t have images available for ARM. In this case, it is recommended to use an alternative image or build your own. The list below contains some tips for specific components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>camel-test-infra-kafka: use the Strimzi images <code>-Dkafka.instance.type=local-strimzi-container</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
